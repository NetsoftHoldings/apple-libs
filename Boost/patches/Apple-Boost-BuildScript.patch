diff --git a/boost.sh b/boost.sh
index 7667306..69d4c42 100755
--- a/boost.sh
+++ b/boost.sh
@@ -694,6 +694,16 @@ patchBoost()
 
         doneSection
     fi
+
+    if [ "$(version "$XCODE_VERSION")" -ge "$(version "12.0")" ]
+    then
+        echo "Patching boost in $BOOST_SRC"
+
+        # https://github.com/boostorg/build/pull/560
+        (cd "$BOOST_SRC" && patch --forward -p1 -d "$BOOST_SRC/tools/build" < "$CURRENT_DIR/patches/xcode-12.0.patch")
+
+        doneSection
+    fi
 }
 
 #===============================================================================
@@ -727,7 +737,7 @@ using darwin : $COMPILER_VERSION~iphone
 : <architecture>arm
   <target-os>iphone
   <cxxflags>"$CXX_FLAGS"
-  <linkflags>"$LD_FLAGS"
+  <linkflags>"$LD_FLAGS ${IOS_ARCH_FLAGS[*]} -isysroot $IOS_SDK_PATH"
   <compileflags>"$OTHER_FLAGS ${IOS_ARCH_FLAGS[*]} $EXTRA_IOS_FLAGS -isysroot $IOS_SDK_PATH"
   <threading>multi
 
@@ -737,7 +747,7 @@ using darwin : $COMPILER_VERSION~iphonesim
 : <architecture>x86
   <target-os>iphone
   <cxxflags>"$CXX_FLAGS"
-  <linkflags>"$LD_FLAGS"
+  <linkflags>"$LD_FLAGS ${IOS_SIM_ARCH_FLAGS[*]} -isysroot $IOSSIM_SDK_PATH"
   <compileflags>"$OTHER_FLAGS ${IOS_SIM_ARCH_FLAGS[*]} $EXTRA_IOS_SIM_FLAGS -isysroot $IOSSIM_SDK_PATH"
   <threading>multi
 ;
@@ -746,7 +756,7 @@ using darwin : $COMPILER_VERSION~appletv
 : <architecture>arm
   <target-os>iphone
   <cxxflags>"$CXX_FLAGS"
-  <linkflags>"$LD_FLAGS"
+  <linkflags>"$LD_FLAGS ${TVOS_ARCH_FLAGS[*]} -isysroot $TVOS_SDK_PATH"
   <compileflags>"$OTHER_FLAGS ${TVOS_ARCH_FLAGS[*]} $EXTRA_TVOS_FLAGS -isysroot $TVOS_SDK_PATH"
   <threading>multi
 ;
@@ -755,7 +765,7 @@ using darwin : $COMPILER_VERSION~appletvsim
 : <architecture>x86
   <target-os>iphone
   <cxxflags>"$CXX_FLAGS"
-  <linkflags>"$LD_FLAGS"
+  <linkflags>"$LD_FLAGS ${TVOS_SIM_ARCH_FLAGS[*]} -isysroot $TVOSSIM_SDK_PATH"
   <compileflags>"$OTHER_FLAGS ${TVOS_SIM_ARCH_FLAGS[*]} $EXTRA_TVOS_SIM_FLAGS -isysroot $TVOSSIM_SDK_PATH"
   <threading>multi
 ;
@@ -764,7 +774,7 @@ using darwin : $COMPILER_VERSION~macos
 : <architecture>x86
   <target-os>darwin
   <cxxflags>"$CXX_FLAGS"
-  <linkflags>"$LD_FLAGS"
+  <linkflags>"$LD_FLAGS ${MACOS_ARCH_FLAGS[*]} -isysroot $MACOS_SDK_PATH"
   <compileflags>"$OTHER_FLAGS ${MACOS_ARCH_FLAGS[*]} $EXTRA_MACOS_FLAGS -isysroot $MACOS_SDK_PATH"
   <threading>multi
 ;
@@ -773,7 +783,7 @@ using darwin : $COMPILER_VERSION~macossilicon
 : <architecture>arm
   <target-os>darwin
   <cxxflags>"$CXX_FLAGS"
-  <linkflags>"$LD_FLAGS"
+  <linkflags>"$LD_FLAGS ${MACOS_SILICON_ARCH_FLAGS[*]} -isysroot $MACOS_SILICON_SDK_PATH"
   <compileflags>"$OTHER_FLAGS ${MACOS_SILICON_ARCH_FLAGS[*]} $EXTRA_MACOS_SILICON_FLAGS -isysroot $MACOS_SILICON_SDK_PATH" -target arm64-apple-macos$MIN_MACOS_SILICON_VERSION
 ;
 using darwin : $COMPILER_VERSION~maccatalyst
@@ -781,7 +791,7 @@ using darwin : $COMPILER_VERSION~maccatalyst
 : <architecture>x86
   <target-os>darwin
   <cxxflags>"$CXX_FLAGS"
-  <linkflags>"$LD_FLAGS"
+  <linkflags>"$LD_FLAGS ${MAC_CATALYST_ARCH_FLAGS[*]} -isysroot $MAC_CATALYST_SDK_PATH"
   <compileflags>"$OTHER_FLAGS ${MAC_CATALYST_ARCH_FLAGS[*]} $EXTRA_MAC_CATALYST_FLAGS -isysroot $MAC_CATALYST_SDK_PATH -target x86_64-apple-ios$MIN_MAC_CATALYST_VERSION-macabi"
   <threading>multi
 ;
@@ -850,6 +860,7 @@ buildBoost_iOS()
     if [ $? != 0 ]; then echo "Error staging iPhone. Check log."; exit 1; fi
 
     ./b2 "$THREADS" \
+        -d+2 --debug-configuration \
         --build-dir=iphone-build \
         --stagedir=iphone-build/stage \
         --prefix="$IOS_OUTPUT_DIR/prefix" \
@@ -1572,7 +1583,7 @@ if [[ -z $BUILD_IOS && -z $BUILD_TVOS && -z $BUILD_MACOS && -z $BUILD_MAC_CATALY
 fi
 
 # Must set these after parseArgs to fill in overridden values
-EXTRA_FLAGS="-fembed-bitcode -Wno-unused-local-typedef -Wno-nullability-completeness"
+EXTRA_FLAGS="-Wno-unused-local-typedef -Wno-nullability-completeness"
 
 # The EXTRA_ARM_FLAGS definition works around a thread race issue in
 # shared_ptr. I encountered this historically and have not verified that
diff --git a/patches/xcode-12.0.patch b/patches/xcode-12.0.patch
new file mode 100644
index 0000000..b21b8d7
--- /dev/null
+++ b/patches/xcode-12.0.patch
@@ -0,0 +1,12 @@
+diff -Nuar a/src/engine/modules/path.c b/src/engine/modules/path.c
+--- a/src/engine/modules/path.c	2015-04-04 12:25:07.000000000 -0500
++++ b/src/engine/modules/path.c	2021-11-12 08:58:15.000000000 -0600
+@@ -9,7 +9,7 @@
+ #include "../lists.h"
+ #include "../native.h"
+ #include "../timestamp.h"
+-
++#include "../filesys.h"
+ 
+ LIST * path_exists( FRAME * frame, int flags )
+ {
